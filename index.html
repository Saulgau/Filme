<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FilmFrei: Dein kostenloses Streaming-Erlebnis – 100% werbefrei!</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#000000">
</head>
<body class="bg-gray-900 text-white transition-colors duration-300">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-center mb-6">FilmFrei: Dein kostenloses Streaming-Erlebnis – 100% werbefrei!</h1>
            <div class="flex justify-center items-center space-x-4 flex-wrap">
                <input type="text" id="search-query" placeholder="Filmtitel suchen..." class="p-2 rounded-full border border-gray-700 bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-400 flex-grow max-w-md">
                <button onclick="searchMovies()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 ease-in-out">
                    Suchen
                </button>
            </div>
        </header>
        <main>
            <section id="horror-section">
                <h2 class="text-2xl font-semibold mb-4">Horror</h2>
                <div id="horror-movies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Horrorfilme werden hier eingefügt -->
                </div>
            </section>

            <section id="fantasy-section" class="mt-12">
                <h2 class="text-2xl font-semibold mb-4">Fantasy</h2>
                <div id="fantasy-movies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Fantasyfilme werden hier eingefügt -->
                </div>
            </section>

            <section id="action-section" class="mt-12">
                <h2 class="text-2xl font-semibold mb-4">Action</h2>
                <div id="action-movies" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Actionfilme werden hier eingefügt -->
                </div>
            </section>

            <!-- Weitere Sektionen für andere Filmkategorien -->
        </main>
    </div>

    <script>
        // Horrorfilme
        const horrorMovies = [
            {
                title: "Der Exorzist FSK 18",
                image: "https://image.tmdb.org/t/p/w500/abcd1234.jpg",
                link: "https://3jtpuy07im.swiftload.io/serve/3/42t6g8weimw/hhOzTyMWmzkPc5LTBQtCBg/1725303013/42t6g8weimw//high.m3u8"
            },
            {
                title: "Hereditary FSK 18",
                image: "https://image.tmdb.org/t/p/w500/efgh5678.jpg",
                link: "https://3jtpuy07im.swiftload.io/serve/3/zg4v2y0cl8r/kqkxn7u_G9Lcu1u-Ipdygg/1725296331/zg4v2y0cl8r//high.m3u8"
            }
        ];

        // Fantasyfilme
        const fantasyMovies = [
            {
                title: "Der Herr der Ringe FSK 12",
                image: "https://image.tmdb.org/t/p/w500/ijkl9012.jpg",
                link: "https://3jtpuy07im.swiftload.io/serve/3/obxbvt06dz8/QlaH3NXuOEv2RjdXVcDEfQ/1725191511/obxbvt06dz8//high.m3u8"
            },
            {
                title: "Harry Potter FSK 6",
                image: "https://image.tmdb.org/t/p/w500/mnop3456.jpg",
                link: "https://3jtpuy07im.swiftload.io/serve/3/e3eq2m4qz9t/reBKNUZNitBLrtdkFPcBEA/1725292119/e3eq2m4qz9t//high.m3u8"
            }
        ];

        // Actionfilme
        const actionMovies = [
            {
                title: "Mad Max FSK 16",
                image: "https://image.tmdb.org/t/p/w500/qrst7890.jpg",
                link: "https://3jtpuy07im.swiftload.io/serve/3/kfvoc2p3auf/OFRNicTzpYI7Zhl0pRoHWQ/1725129465/kfvoc2p3auf//high.m3u8"
            },
            {
                title: "John Wick FSK 18",
                image: "https://image.tmdb.org/t/p/w500/uvwx1234.jpg",
                link: "https://3jtpuy07im.swiftload.io/serve/3/qwertyu9i7/OFRNicTzpYI7Zhl0pRoHWQ/1725129465/qwertyu9i7//high.m3u8"
            }
        ];

        // Filme anzeigen
        function displayMovies(category, movieList) {
            const sectionElement = document.getElementById(`${category}-movies`);
            sectionElement.innerHTML = movieList.map(movie => `
                <div class="bg-gray-800 rounded-lg shadow-md overflow-hidden transition-transform duration-300 ease-in-out transform hover:-translate-y-1 hover:shadow-lg">
                    <img src="${movie.image}" alt="${movie.title}" class="w-full h-64 object-cover" onerror="this.src='https://via.placeholder.com/400x300?text=Bild+nicht+verfügbar'">
                    <div class="p-4">
                        <h2 class="text-xl font-semibold mb-2">${movie.title}</h2>
                        <button onclick="openPlayer('${movie.link}', '${movie.title}')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-300 ease-in-out w-full">
                            Film ansehen
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Player öffnen
        function openPlayer(m3u8Url, title) {
            const playerWindow = window.open("", "_blank");
            playerWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Filmwiedergabe</title>
                    <style>
                        body { margin: 0; background-color: #000; display: flex; justify-content: center; align-items: center; height: 100vh; }
                        #videoPlayer { width: 100%; max-width: 1280px; height: auto; max-height: 90vh; }
                    </style>
                </head>
                <body>
                    <video id="videoPlayer" controls></video>
                    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"><\/script>
                    <script>
                        const video = document.getElementById('videoPlayer');
                        const m3u8Url = '${m3u8Url}';
                        const cookieName = 'videoTime_' + encodeURIComponent('${title}');
                        
                        // Zeit aus dem Cookie laden
                        const savedTime = parseFloat(getCookie(cookieName)) || 0;

                        if (Hls.isSupported()) {
                            const hls = new Hls();
                            hls.loadSource(m3u8Url);
                            hls.attachMedia(video);
                            hls.on(Hls.Events.MANIFEST_PARSED, function () {
                                video.currentTime = savedTime;
                                video.play();
                            });
                        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                            video.src = m3u8Url;
                            video.addEventListener('loadedmetadata', function () {
                                video.currentTime = savedTime;
                                video.play();
                            });
                        }

                        // Zeit beim Schließen des Fensters speichern
                        window.addEventListener('beforeunload', function () {
                            setCookie(cookieName, video.currentTime, 365);
                        });

                        function getCookie(name) {
                            const value = \`; \${document.cookie}\`;
                            const parts = value.split(\`; \${name}=\`);
                            if (parts.length === 2) return parts.pop().split(';').shift();
                        }

                        function setCookie(name, value, days) {
                            const expires = new Date(Date.now() + days * 864e5).toUTCString();
                            document.cookie = name + '=' + value + '; expires=' + expires + '; path=/';
                        }
                    <\/script>
                </body>
                </html>
            `);
        }

        // Suchfunktion
        function searchMovies() {
            const query = document.getElementById("search-query").value.toLowerCase();
            filterMovies("horror", horrorMovies, query);
            filterMovies("fantasy", fantasyMovies, query);
            filterMovies("action", actionMovies, query);
        }

        // Filme filtern
        function filterMovies(category, movieList, query) {
            const filteredMovies = movieList.filter(movie => movie.title.toLowerCase().includes(query));
            displayMovies(category, filteredMovies);
        }

        // Initialisierung der Filme
        function init() {
            displayMovies("horror", horrorMovies);
            displayMovies("fantasy", fantasyMovies);
            displayMovies("action", actionMovies);
        }

        // Seite initialisieren
        window.onload = init;
    </script>
</body>
</html>
